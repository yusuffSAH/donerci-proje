@model MertcanDoner.ViewModels.UserOrderViewModel

@{
    ViewData["Title"] = "SipariÅŸ GeÃ§miÅŸim";
}


<h2 class="mb-4">ğŸ§¾ SipariÅŸlerim</h2>

@if (!Model.ActiveOrders.Any() && !Model.PastOrders.Any())
{
    <div class="alert alert-info">HenÃ¼z hiÃ§ sipariÅŸ vermemiÅŸsiniz.</div>
}
else
{
    @if (Model.ActiveOrders.Any())
    {
        <h4 class="text-primary">ğŸ“¦ Aktif SipariÅŸler</h4>
        @foreach (var order in Model.ActiveOrders)
        {
           @await Html.PartialAsync("_UserOrderCard", order)
        }
    }

    @if (Model.PastOrders.Any())
    {
        <h4 class="mt-4 text-secondary">ğŸ“ GeÃ§miÅŸ SipariÅŸler</h4>
        @foreach (var order in Model.PastOrders)
        {
           @await Html.PartialAsync("_UserOrderCard", order)
        }
    }
}
<script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.5/signalr.min.js"></script>
<script>
    const connection = new signalR.HubConnectionBuilder()
        .withUrl("/notificationHub")
        .build();

    // ğŸµ Ses dosyasÄ±nÄ± yÃ¼kle
    const notificationSound = new Audio('/sounds/male-you-have-new-message-tone.mp3'); // ğŸ“ /wwwroot/sounds/notify.mp3 olmalÄ±

    // âœ… Bildirim geldiÄŸinde yapÄ±lacaklar
    connection.on("ReceiveNotification", function (message) {
        notificationSound.play(); // ğŸ”Š sesi Ã§al
        alert("ğŸ“¢ " + message);   // ğŸŸ¡ bildirim kutusu
        location.reload();        // ğŸ”„ sayfayÄ± yenile
    });

    // ğŸ”„ BaÄŸlantÄ±yÄ± baÅŸlat
    connection.start().catch(function (err) {
        console.error("SignalR baÄŸlantÄ± hatasÄ±:", err.toString());
    });
</script>

